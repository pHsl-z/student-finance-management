<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>交易记录排序测试</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-case { margin: 20px 0; padding: 15px; border: 1px solid #ccc; }
        .result { margin: 10px 0; padding: 10px; background: #f5f5f5; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>交易记录排序逻辑测试</h1>
    
    <div class="test-case">
        <h3>测试：按创建时间排序</h3>
        <p>验证交易记录是否按 created_at 字段降序排列（最新录入的记录在前）</p>
        
        <div class="result">
            <h4>测试数据：</h4>
            <pre id="testData"></pre>
        </div>
        
        <div class="result">
            <h4>排序结果：</h4>
            <pre id="sortResult"></pre>
        </div>
        
        <div class="result">
            <h4>测试结论：</h4>
            <div id="testConclusion"></div>
        </div>
    </div>

    <script>
        // 模拟交易记录数据
        const mockTransactions = [
            {
                id: 1,
                student_name: '张三',
                amount: 1000,
                transaction_date: '2024-01-15',
                created_at: '2024-01-15T10:30:00Z',
                status: 'paid'
            },
            {
                id: 2,
                student_name: '李四',
                amount: 800,
                transaction_date: '2024-01-14',
                created_at: '2024-01-16T14:20:00Z',
                status: 'pending'
            },
            {
                id: 3,
                student_name: '王五',
                amount: 1200,
                transaction_date: '2024-01-13',
                created_at: '2024-01-17T09:15:00Z',
                status: 'paid'
            }
        ];

        // 显示测试数据
        document.getElementById('testData').textContent = JSON.stringify(mockTransactions, null, 2);

        // 按 created_at 降序排序（最新录入的记录在前）
        const sortedByCreatedAt = [...mockTransactions].sort((a, b) => 
            new Date(b.created_at) - new Date(a.created_at)
        );

        // 显示排序结果
        document.getElementById('sortResult').textContent = JSON.stringify(sortedByCreatedAt, null, 2);

        // 验证排序是否正确
        const isCorrectlySorted = sortedByCreatedAt[0].id === 3 && 
                                  sortedByCreatedAt[1].id === 2 && 
                                  sortedByCreatedAt[2].id === 1;

        // 显示测试结论
        const conclusion = document.getElementById('testConclusion');
        if (isCorrectlySorted) {
            conclusion.innerHTML = '<span class="success">✓ 测试通过：交易记录已按创建时间降序排列，最新录入的记录显示在最前面。</span>';
        } else {
            conclusion.innerHTML = '<span class="error">✗ 测试失败：排序逻辑有问题。</span>';
        }

        // 对比：按交易日期排序的结果
        const sortedByTransactionDate = [...mockTransactions].sort((a, b) => 
            new Date(b.transaction_date) - new Date(a.transaction_date)
        );

        console.log('按交易日期排序：', sortedByTransactionDate.map(t => ({id: t.id, date: t.transaction_date, created: t.created_at})));
        console.log('按创建时间排序：', sortedByCreatedAt.map(t => ({id: t.id, date: t.transaction_date, created: t.created_at})));
    </script>
</body>
</html>